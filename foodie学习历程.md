[TOC]



# foodie学习记录

## 1. 为什么不使用数据库外键?

- 性能影响

  检查数据完整性，强一致性，降低效率

- 热更新

  无法完成热更新

- 降低耦合性

  可以在业务逻辑上完成

- 数据分库分表

  有外键关联，难以做分库分表，耦合度太高。数据放在两个数据库中，存在外键关联无法分离。

## 2. Restful Web Service

- 通信方式
- 信息传递
- 无状态
- 独立性

## 3. Rest设计规范

- GET:获取  	 			-> /order/{id}
- POST:添加				-> /order
- PUT:更新					-> /order/{id}
- DELETE:删除			->/order/{id}
- PATCH:部分更新		->/order/{id}

**url中采用名词描述,不使用动词描述**



## 4. 事务的传播-Propagation

REQUIRED:使用当前的事务,如果当前没有事务,则自己新建一个事务,子方法必须运行在一个事务中,如果当前存在事务,则加入这个事务,成为一个整体。

SUPPORTS：如果当前有事务，则使用事务；如果当前没有事务，则不使用事务

MANDATORY：该传播属性强制必须存在一个事务，如果不存在，则抛出异常

REQUIRES_NEW：如果当前有事务，则挂起该事务，并且自己创建一个新的事务给自己使用；如果当前没有事务，则同REQUIRED

NOT_SUPPORTED：以非事务形式执行，如果当前存在事务则挂起

NEVER：如果当前有事务存在，则抛出异常

NESTED：如果当前有事务则开启子事务（嵌套事务），嵌套事务是独立提交的，如果当前没有事务，则同REQUIRED。但是如果父事务提交，则携带子事务一起提交。如果父事务回滚，则子事务会一起回滚。相反，子事务异常，则父事务可以回滚或不回滚。

## 5. 创建分布式全局唯一ID

1.使用UUID，缺点：UUID过长且无序，InnoDB根据主键排序，会造成过大的IO压力。

1.使用自增主键，加UUID唯一索引，把自增主键看成形式上的主键，缺点：自增主键有最大值，会产生溢出

2.每个数据库id起始不同,采用相同步长

3.另一个数据库中存储当前id，获取全局唯一的自增序列号或者各表的MaxID（如Redis)，缺点：引入新的组件，复杂度上升。同时存在单点问题，可用性降低。

4.Twitter的SnowFlake和美团  的Leaf





