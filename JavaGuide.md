# 计算机基础

[TOC]



## 3.1 计算机网络

### 3.1.1 OSI与TCP/IP各层的结构和功能

1.OSI结构体系7层

​    应用层->表示层->会话层->运输层->网络层->数据链路层->物理层

2.TCP/IP的体系结构

​    应用层->运输层->网际层->网络接口层

3.五层协议

​    应用层->运输层->网络层->数据链路层->物理层

#### 应用层

应用层的任务是通过应用进程间的交互来完成特定网络应用。

DNS HTTP SMTP POP3

#### 运输层

运输层的主要任务就是负责向两台主机进程之间的通信提供通用的数据传送服务。

运输层的两种主要协议：

1. TCP(Transmission Control Protocol) -- 提供**面向连接**的，**可靠的**数据传输服务
2. UDP(User Datagram Protocol)--提供**无连接**的，尽最大努力的数据传输服务（不保证数据传输的可靠性）

#### 网络层

在计算机网络中进行通信的两个计算机之间可能会经过很多个数据链路，也可能还要经过很多通信子网。网络层的任务就是选择合适的网间路由和交换结点，确保数据及时传送。

#### 数据链路层

两台主机之间的数据传输，总是在一段一段的链路上传送的，这就需要使用专门的链路层的协议。数据链路层将网络层交下来的IP数据包组成帧。

#### 物理层

实现相邻计算机节点之间比特流的透明传送，尽可能屏蔽掉具体传输介质和物理设备的差异。

!['OSI7层结构体系'](image/OSI.png)

### 3.1.2 TCP三次握手和四次挥手

为了准确无误地把数据送达目标处，TCP协议采用了三次握手策略。

#### TCP三次握手流程

![三次握手](image/三次握手.png)

- 客户端-发送带有SYN标志的数据包-服务端 （一次握手）

- 服务端-发送带有SYN/ACK标志的数据包-客户端（二次握手）

  客户端-发送带有ACK标志的数据包-服务端（三次握手）

- 

#### 为什么要三次握手

三次握手的目的是为了建立可靠的通信信道。三次握手最主要的目的就是双方确认自己与对方的发送和接受是正常的。

```
第一次握手：Client什么都无法确认；Server可确认对方发送正常，自己接收正常。
第二次握手：Client可确认自己发送、接收正常，对方发送、接收正常；Server确认对方发送正常，自己接收正常(无法根据这次握手，增加判断)。
第三次握手：Client确认自己发送、接收正常，对方发送、接收正常；Server可确认对方发送、接收正常，自己发送、接收正常。
```

#### 为什么第二次握手要传回SYN

接收端传回发送端所发送端SYN是为了告诉发送端，我接受到的信息确实就是你所发送的信号。

#### 为什么传了SYN，还要传ACK

双方通信无误必须两者互相发送信息都无误。传了SYN，证明发送方到接收方的通道没有问题，但是接收方到发送方的通道还需要ACK信号来进行验证。

#### 四次挥手

![四次挥手](image/四次挥手.png)

断开一个TCP连接则需要“四次挥手”

- 客户端-发送一个FIN-服务端，用于关闭客户端到服务器的数据传送（第一次挥手）
- 服务端-收到FIN，发送一个ACK，确认序号为收到序号+1。
- 服务端-发送一个FIN-客户端，用于关闭与客户端的连接
- 客户端-发回ACK报文确认，并将确认序号设置为收到序号+1

#### 为什么要四次挥手

任何一方都可以在数据传送结束后发出连接释放的通知，待对方确认后进入半关闭状态。当另一方也没有数据再发送的时候，则发出连接释放通知，对方确认后就完全关闭了TCP连接。

### 3.1.2 TCP,UDP协议的区别

![image-20210106161735912](C:\Users\Administrator\Desktop\image-20210106161735912.png)

UDP传送数据之前不需要建立连接，提供一个无连接的数据传输服务，远程主机在收到UDP报文后，不需要给出任何确认。传输效率高，虽然不提供可靠交互，但在某些情况下UDP确是一种最有效的工作方式（一般用于即时通信），比如QQ语音、QQ视频、直播等。

```
为什么UDP不可靠，还要应用于即时通信呢？
   UDP不可靠但是效率高，传输开销小，无连接不会持续占用服务器的连接资源，适用于实时数据的传输，即使偶尔丢失一两个数据包，也不会对接受结果产生太大影响。
```

TCP提供面向连接的服务。在传送数据之前必须建立连接，数据传送结束后要释放连接。TCP不提供广播或者多播服务。由于TCP提供可靠的、面向连接的传输服务，难以避免的增加了许多开销，如确认、流量控制、计时器以及连接管理。这不仅使协议数据单元的首部增大很多，还要占用许多的处理机资源。TCP一般用于文件传输、发送和接受邮件、远程登录等场景。

### 3.1.3 TCP 协议如何保证可靠传输

应用数据被分割成TCP认为最适合发送的数据块

TCP给发送的每一个包进行编号，接收方对数据包进行排序，把有序数据传送给应用层。

**校验和：**TCP将保持它首部和数据的校验和。这是一个端对端的校验和，目的是检测数据在传输过程中的任何变化。如果收到段的检验和有差错，TCP将丢弃这个保温段和不确认收到此报文段。

TCP的接收端会丢弃重复的数据。

**流量控制：**TCP连接的每一方都有固定大小的缓冲空间，TCP的接收端只允许发送端发送接收端缓冲区能接纳的数据。当接收方来不及处理发送方的数据，能提示发送方降低发送的速率，防止包丢失。TCP使用的流量协议是可变大小的滑动窗口协议。

**拥塞控制：**当网络拥塞时，减少数据的发送。

**ARQ协议：**也是为了实现可靠传输的，它的基本原理就是每发完一个分组就停止发送，等待对方确认。在收到确认后再发下一个分组。

**超时重传：**当TCP发出一个段后，它启动一个定时器，等待目的端确认收到这个报文段。如果不能及时收到一个确认，将重发这个报文段。